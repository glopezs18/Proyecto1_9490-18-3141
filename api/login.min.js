const express=require("express"),mongoose=require("mongoose"),{usersModel:usersModel}=require("../includes/models.js"),jwt=require("jsonwebtoken");var login=express.Router();login.use(express.json()),mongoose.connect("mongodb://127.0.0.1:27017/proyecto1_9490-18-3141"),login.get("/",(req,res)=>{res.json({message:"Nodejs, JWT and MongoDB"})}),login.post("/",(function(req,res){const user={correoElectronico:req.body.correoElectronico,clave:req.body.clave};usersModel.find({correoElectronico:user.correoElectronico}).then((function(data){const validate=data[0].clave==user.clave;validate&&jwt.sign({user:user},"secretkey",(err,token)=>{res.json({message:"Acceso existoso",token:token})})})).catch((function(err){console.log(err)}))})),module.exports=login;